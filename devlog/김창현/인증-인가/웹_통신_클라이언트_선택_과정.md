# 웹 통신 클라이언트 선택 과정

OAuth를 구현하던 중, callback api를 네이버에서 받고, 그 code 값을 통해 토큰이나 사용자 정보를
네이버에서 받는 과정에서 웹 통신 클라이언트를 사용하게 되었다.
해당 방식에 대해 구글링 해 보니 다수의 참고 자료에서 RestTemplate으로 이것을 구현한 것을 확인할 수 있었다.
하지만 실제로 구현하려고 하니 RestTemplate은 현재 Spring 에서 권장하지 않는다는 것이었다.
따라서 이에 따른 대안으로 여러 가지 정책을 비교 분석하여 선택하고자 한다.

## 각 정책 비교

1. WebClient
    - 장점
      - spring webflux와 호환도가 높다.
      - 함수처럼 사용할 수 있어 직관적이다.
      - Mono와 Flux를 통해 스트리밍 데이터를 처리할 수 있다.
      - 비동기 처리에 특화되어 있다. (Not-blocking I/O 기능 제공)
    - 단점
      - spring webflux 의존성을 추가해야 하기에 프로젝트가 무거워질 수 있다.
      - 디버깅이 복잡할 수 있다
2. RestTemplate/HttpClient
    - 장점
       - 사용 방법이 간단하다
       - 동기 처리가 편리하다.
    - 단점
      - deprecated 되어 점차 WebClient 로 대체될 예정이다. 
      - 비동기 처리를 위해서는 추가 설정을 해야한다.
3. OKHttp
    - 장점
      - 성능이 좋고 안정적이다.
      - 캐시를 지원한다.
      - 인터셉터로 Request/Response 커스터마이징이 쉽다.
    - 단점
      - Spring과 통합을 위해서는 추가 설정이 필요하다.
      - 비동기 처리를 위해 콜백 처리가 별도로 필요하다.
4. OpenFeign
    - 장점
      - spring cloud와 호환도가 높다.
      - 코드가 간결하다.
      - 가독성이 좋다
      - Netflix가 개발하여 현재 시장의 트렌드이다.
    - 단점
      - Spring cloud 의존성이 필요하다.
      - 커스터마이징을 위해서는 추가 설정을 해야 한다.
      - 복잡한 Request/Response 처리는 어려울 수 있다.

## 의사 결정 과정

기존 레거시 방식의 RestTemplate나 HttpClient는 지양하고 최신 기술을 사용하고자 한다.

OkHttp는 Spring security와의 통합성이 좋지는 않아 기본 세팅을 해야 하고, 코드가 생각보다 길어진다.

따라서 WebClient와 OpenFeign 두 가지 중 하나를 선택하고자 한다.

OpenFeign 혹은 WebClient를 사용하면 의존성을 추가해야 하긴 하지만 코드가 매우 간결해지고, 가독성이 높다.

현재 프로젝트는 비동기 방식은 고려하지 않아도 된다. 로그인에서 사용할 것인데, 로그인은 반드시 순차적으로 이루어져야 한다.
WebClient를 현재 프로젝트에 적용하려면 마지막에 반드시 .block()을 붙여 주어 비동기 방식으로 동작하지 않도록 설정해야 한다.
이러한 과정이 불필요하다고 생각했고, 따라서 비동기적 방식에 특화되어 있는 WebClient보다는 OpenFeign을 사용하는 것이 적합하다고 판단했다.

[OpenFeign 사용 트러블슈팅](OpenFeign_트러블슈팅.md)